<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ú•Û†Ù…Û† Ù‡Û†Ø³ - Ú©Ø§ÚµØ§Ú©Ø§Ù† Ø¨Û•Ù¾ÛÛŒ Ø¬Û†Ø±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; direction: rtl; font-size: 14px; }
        .app-container { max-width: 100%; margin: 0 auto; background: white; min-height: 100vh; position: relative; }
        
        /* Header */
        .header { background: white; padding: 12px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e0e0e0; position: sticky; top: 0; z-index: 100; }
        .header h1 { font-size: 14px; color: #333; font-weight: 600; }
        .bell-icon { width: 35px; height: 35px; background: #f0f0f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; }
        .bell-icon:hover { background: #e0e0e0; }
        .bell-icon i { color: #555; font-size: 16px; }

        /* Banner */
        .banner { background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%); padding: 25px 15px; text-align: center; color: white; position: relative; cursor: pointer; }
        .logo { width: 70px; height: 70px; background: rgba(255,255,255,0.3); border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); overflow: hidden; }
        .logo img { width: 100%; height: 100%; object-fit: cover; }
        .banner h2 { font-size: 20px; margin-bottom: 5px; font-weight: 700; }
        .banner p { font-size: 12px; opacity: 0.95; }

        /* Category Navigation */
        .category-nav { display: flex; overflow-x: auto; padding: 12px 15px; background: white; border-bottom: 1px solid #f0f0f0; gap: 8px; scrollbar-width: none; position: sticky; top: 59px; z-index: 99; }
        .category-nav::-webkit-scrollbar { display: none; }
        .category-item { flex: 0 0 auto; text-align: center; padding: 8px 16px; background: #f8f9fa; border-radius: 20px; cursor: pointer; transition: all 0.3s; border: 1px solid transparent; white-space: nowrap; font-size: 13px; font-weight: 500; }
        .category-item.active { background: #4fc3f7; color: white; border-color: #29b6f6; box-shadow: 0 2px 8px rgba(79, 195, 247, 0.3); }
        .category-item:hover { background: #e9ecef; transform: translateY(-2px); }
        .category-item.active:hover { background: #29b6f6; }

        /* Products Grid */
        .products-section { padding: 15px; }
        .products-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 15px; }
        .product-item { background: white; border-radius: 12px; padding: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.3s, box-shadow 0.3s; border: 1px solid #f0f0f0; position: relative; }
        .product-item.new-product { border: 2px solid #ff9800; box-shadow: 0 2px 10px rgba(255, 152, 0, 0.2); }
        .new-badge { position: absolute; top: -5px; left: -5px; background: #ff9800; color: white; font-size: 10px; padding: 2px 6px; border-radius: 8px; z-index: 2; }
        .product-item:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .product-image { width: 100%; height: 90px; border-radius: 8px; overflow: hidden; margin-bottom: 8px; background: #f8f9fa; display: flex; align-items: center; justify-content: center; position: relative; }
        .product-image img { width: 100%; height: 100%; object-fit: cover; }
        .product-image .placeholder-icon { font-size: 28px; color: #ccc; }
        .product-info { text-align: center; }
        .product-name { font-size: 13px; font-weight: 600; color: #333; margin-bottom: 4px; }
        .product-price { font-size: 14px; font-weight: 700; color: #4fc3f7; }
        .product-price-usd { font-size: 11px; color: #888; margin-top: 2px; }
        .product-code { font-size: 10px; color: #888; margin-top: 2px; }
        .product-date { font-size: 9px; color: #aaa; margin-top: 2px; }

        /* Price Eye Icon */
        .price-eye { position: absolute; top: 8px; right: 8px; background: rgba(255,255,255,0.9); width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; z-index: 3; }
        .price-eye:hover { background: #4fc3f7; color: white; transform: scale(1.1); }
        .price-eye i { font-size: 12px; }

        /* Admin Panel */
        .admin-panel { background: #f8f9fa; padding: 15px; margin: 15px; border-radius: 10px; border: 1px solid #e9ecef; display: none; }
        .admin-panel.show { display: block; animation: slideDown 0.3s ease-out; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        .admin-title { font-size: 16px; color: #333; margin-bottom: 12px; text-align: center; }
        .admin-form { display: flex; flex-direction: column; gap: 8px; }
        .admin-input { padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; }
        .admin-select { padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; background: white; }
        .admin-file-input { padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 13px; background: white; }
        .admin-button { background: #4fc3f7; color: white; border: none; padding: 10px; border-radius: 6px; cursor: pointer; font-size: 13px; transition: all 0.3s; }
        .admin-button:hover { background: #29b6f6; }
        .admin-button.delete { background: #f44336; }
        .admin-button.delete:hover { background: #d32f2f; }
        .image-preview { width: 80px; height: 80px; border-radius: 8px; overflow: hidden; margin: 8px auto; background: #f8f9fa; display: flex; align-items: center; justify-content: center; }
        .image-preview img { width: 100%; height: 100%; object-fit: cover; }
        .image-preview .placeholder-text { color: #888; font-size: 10px; text-align: center; }

        /* Edit and Delete Buttons (Only in Admin Panel) */
        .product-actions { position: absolute; top: 8px; left: 8px; display: flex; gap: 5px; z-index: 3; }
        .edit-btn, .delete-btn { width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; font-size: 12px; }
        .edit-btn { background: rgba(76, 175, 80, 0.9); color: white; }
        .edit-btn:hover { background: #4caf50; transform: scale(1.1); }
        .delete-btn { background: rgba(244, 67, 54, 0.9); color: white; }
        .delete-btn:hover { background: #f44336; transform: scale(1.1); }

        /* Loading Spinner */
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #4fc3f7; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Notification styles */
        .notification { position: fixed; top: 80px; right: 15px; left: 15px; background: #4caf50; color: white; padding: 15px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 10000; font-size: 13px; text-align: center; animation: slideIn 0.3s ease-out; }
        .notification.error { background: #f44336; }
        @keyframes slideIn { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideOut { from { transform: translateY(0); opacity: 1; } to { transform: translateY(-100%); opacity: 0; } }

        /* Contact Section */
        .contact-section { background: #f8f9fa; padding: 20px 15px; margin-top: 20px; border-top: 1px solid #e9ecef; }
        .contact-title { font-size: 16px; color: #333; margin-bottom: 15px; text-align: center; font-weight: 600; }
        .contact-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .contact-item { background: white; border-radius: 10px; padding: 15px; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.1); transition: all 0.3s; border: 1px solid #f0f0f0; }
        .contact-item:hover { transform: translateY(-3px); box-shadow: 0 4px 10px rgba(0,0,0,0.15); }
        .contact-icon { width: 40px; height: 40px; background: #4fc3f7; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; }
        .contact-icon i { color: white; font-size: 18px; }
        .contact-label { font-size: 12px; color: #666; margin-bottom: 5px; }
        .contact-value { font-size: 14px; color: #333; font-weight: 600; }
        
        /* Footer */
        .footer { background: #333; color: white; padding: 15px; text-align: center; font-size: 12px; margin-top: 20px; }
        .footer p { margin-bottom: 5px; }
        
        /* Home/Pay/Location/Setting/Market/Marketplace Links */
        .quick-links { display: flex; justify-content: space-around; padding: 15px; background: white; border-top: 1px solid #e0e0e0; border-bottom: 1px solid #e0e0e0; margin-top: 20px; }
        .quick-link { text-align: center; cursor: pointer; transition: all 0.3s; }
        .quick-link-icon { width: 40px; height: 40px; background: #f8f9fa; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 8px; }
        .quick-link-icon i { color: #4fc3f7; font-size: 18px; }
        .quick-link:hover .quick-link-icon { background: #4fc3f7; }
        .quick-link:hover .quick-link-icon i { color: white; }
        .quick-link-label { font-size: 11px; color: #666; }
        .quick-link:hover .quick-link-label { color: #4fc3f7; }

        /* Admin Products Grid */
        .admin-products-section { max-height: 400px; overflow-y: auto; margin-top: 15px; border: 1px solid #e0e0e0; border-radius: 8px; padding: 10px; background: white; }
        .admin-products-title { font-size: 14px; color: #333; margin-bottom: 10px; text-align: center; font-weight: 600; }
        
        /* Password Prompt */
        .password-prompt { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .password-container { background: white; padding: 20px; border-radius: 10px; width: 300px; text-align: center; }
        .password-title { font-size: 16px; margin-bottom: 15px; color: #333; }
        .password-input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 15px; font-size: 14px; }
        .password-buttons { display: flex; gap: 10px; }
        .password-button { flex: 1; padding: 10px; border: none; border-radius: 6px; cursor: pointer; }
        .password-submit { background: #4fc3f7; color: white; }
        .password-cancel { background: #f0f0f0; color: #333; }

        /* Image Slider Styles - Fixed */
        .image-slider { 
            position: relative; 
            width: 100%; 
            height: 100%; 
            overflow: hidden; 
            border-radius: 8px;
        }
        .slider-container { 
            display: flex; 
            transition: transform 0.4s ease-in-out; 
            height: 100%; 
            width: 100%;
        }
        .slider-image { 
            flex: 0 0 100%; 
            height: 100%; 
            object-fit: cover; 
            display: block;
        }
        .slider-nav { 
            position: absolute; 
            bottom: 8px; 
            left: 0; 
            right: 0; 
            display: flex; 
            justify-content: center; 
            gap: 6px; 
            z-index: 2;
        }
        .slider-dot { 
            width: 8px; 
            height: 8px; 
            border-radius: 50%; 
            background: rgba(255,255,255,0.6); 
            cursor: pointer; 
            transition: all 0.3s; 
            border: 1px solid rgba(0,0,0,0.2);
        }
        .slider-dot.active { 
            background: white; 
            transform: scale(1.3); 
            box-shadow: 0 0 4px rgba(0,0,0,0.5);
        }
        .slider-dot:hover {
            background: rgba(255,255,255,0.9);
        }
        .slider-arrow { 
            position: absolute; 
            top: 50%; 
            transform: translateY(-50%); 
            background: rgba(0,0,0,0.5); 
            color: white; 
            border: none; 
            width: 28px; 
            height: 28px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            transition: all 0.3s; 
            opacity: 0; 
            z-index: 2;
        }
        .product-image:hover .slider-arrow { 
            opacity: 1; 
        }
        .slider-arrow:hover { 
            background: rgba(0,0,0,0.8); 
            transform: translateY(-50%) scale(1.1);
        }
        .slider-arrow.prev { 
            right: 6px; 
        }
        .slider-arrow.next { 
            left: 6px; 
        }
        .slider-arrow i { 
            font-size: 14px; 
        }

        /* Multiple Image Upload */
        .multiple-images-preview { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 8px; 
            margin: 8px 0; 
            justify-content: center; 
        }
        .multiple-image-item { 
            width: 60px; 
            height: 60px; 
            border-radius: 6px; 
            overflow: hidden; 
            position: relative; 
            border: 1px solid #ddd; 
        }
        .multiple-image-item img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
        }
        .remove-image { 
            position: absolute; 
            top: 2px; 
            right: 2px; 
            background: rgba(244,67,54,0.8); 
            color: white; 
            border: none; 
            width: 16px; 
            height: 16px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            cursor: pointer; 
            font-size: 10px; 
        }

        /* Date Filter Section */
        .date-filter-section {
            background: #f8f9fa;
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        .date-filter-label {
            font-size: 13px;
            color: #333;
            font-weight: 500;
        }
        .date-filter-select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 12px;
            background: white;
            min-width: 150px;
        }
        .date-filter-button {
            background: #4fc3f7;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        .date-filter-button:hover {
            background: #29b6f6;
        }
        .date-display {
            font-size: 11px;
            color: #666;
            margin-left: auto;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <h1>PAYWAST MAJEED...</h1>
            <div class="bell-icon" id="adminAccessBtn">
                <i class="fas fa-user-cog"></i>
            </div>
        </div>

        <div class="content-wrapper">
            <!-- Banner -->
            <div class="banner">
                <div class="logo">
                    <img src="https://raw.githubusercontent.com/paywastwork-droid/PromoHouse/main/logo/photo_2025-11-26_10-42-27.jpg" alt="Promo House Logo">
                </div>
                <h2>PROMO HOUSE</h2>
                <p>For Promotional Products</p>
            </div>

            <!-- Date Filter Section -->
            <div class="date-filter-section">
                <div class="date-filter-label">Ú•ÛÚ©Ø®Ø³ØªÙ†ÛŒ Ø¨Û•Ø±ÙˆØ§Ø±:</div>
                <select class="date-filter-select" id="dateFilter">
                    <option value="all">Ù‡Û•Ù…ÙˆÙˆ Ú©Ø§ÚµØ§Ú©Ø§Ù†</option>
                    <option value="today">Ø¦Û•Ù…Ø±Û†</option>
                    <option value="yesterday">Ø¯ÙˆÛÙ†Û</option>
                    <option value="week">Ø¦Û•Ù… Ù‡Û•ÙØªÛ•ÛŒÛ•</option>
                    <option value="month">Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•</option>
                    <option value="new">Ú©Ø§ÚµØ§ÛŒ Ù†ÙˆÛ (Ù§ Ú•Û†Ú˜ Ù„Û•Ù…Û•ÙˆÙ¾ÛØ´)</option>
                </select>
                <button class="date-filter-button" id="applyDateFilter">Ø¬ÛØ¨Û•Ø¬ÛÚ©Ø±Ø¯Ù†</button>
                <div class="date-display" id="dateDisplay"></div>
            </div>

            <!-- Category Navigation -->
            <div class="category-nav" id="categoryNav">
                <div class="category-item active" data-category="all">Ù‡Û•Ù…ÙˆÙˆ Ú©Ø§ÚµØ§Ú©Ø§Ù†</div>
                <div class="category-item" data-category="clothing">Ø¬Ù„</div>
                <div class="category-item" data-category="hat">Ú©ÚµØ§Ùˆ</div>
                <div class="category-item" data-category="mug">Ú©ÙˆÙˆÙ¾</div>
                <div class="category-item" data-category="watermelon">ØªÛ•Ø±Ù…Û†Ø²Û•</div>
                <div class="category-item" data-category="notebook">Ø¯Û•ÙØªÛ•Ø±</div>
                <div class="category-item" data-category="pen">Ù‚Û•Ù„Û•Ù…</div>
                <div class="category-item" data-category="bag">Ø¬Ø§Ù†ØªØ§</div>
                <div class="category-item" data-category="crystal">Ú©Ø±ÛŒØ³ØªØ§Ù„</div>
                <div class="category-item" data-category="shield">Ø¯Ø±Ø¹</div>
                <div class="category-item" data-category="krikar">Ú©Ø±ÛŒÚ©Ø§Ø±</div>
                <div class="category-item" data-category="other">Ø´ØªÛŒ ØªØ±</div>
            </div>

            <!-- Products Grid -->
            <div class="products-section">
                <div class="products-grid" id="productsContainer">
                    <div style="text-align: center; grid-column: 1 / -1; padding: 20px;">
                        <div class="loading"></div>
                        <div>Ú©Ø§ÚµØ§Ú©Ø§Ù† Ø¨Ø§Ø± Ø¯Û•Ú©Ø±ÛÙ†...</div>
                    </div>
                </div>
            </div>

            <!-- Quick Links (Moved to bottom) -->
            <div class="quick-links">
                <div class="quick-link" onclick="showNotification('Ø¨Û•Ø´ÛŒ Ù…Ø§ÚµÛ•ÙˆÛ•', 'success')">
                    <div class="quick-link-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <div class="quick-link-label">Ù…Ø§ÚµÛ•ÙˆÛ•</div>
                </div>
                <div class="quick-link" onclick="showNotification('Ø¨Û•Ø´ÛŒ Ù¾Ø§Ø±Û•Ø¯Ø§Ù†', 'success')">
                    <div class="quick-link-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <div class="quick-link-label">Ù¾Ø§Ø±Û•Ø¯Ø§Ù†</div>
                </div>
                <div class="quick-link" onclick="showNotification('Ø¨Û•Ø´ÛŒ Ø´ÙˆÛÙ†', 'success')">
                    <div class="quick-link-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="quick-link-label">Ø´ÙˆÛÙ†</div>
                </div>
                <div class="quick-link" onclick="showNotification('Ø¨Û•Ø´ÛŒ Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù†', 'success')">
                    <div class="quick-link-icon">
                        <i class="fas fa-cog"></i>
                    </div>
                    <div class="quick-link-label">Ú•ÛÚ©Ø®Ø³ØªÙ†</div>
                </div>
                <div class="quick-link" onclick="showNotification('Ø¨Û•Ø´ÛŒ Ø¨Ø§Ø²Ø§Ø±', 'success')">
                    <div class="quick-link-icon">
                        <i class="fas fa-store"></i>
                    </div>
                    <div class="quick-link-label">Ø¨Ø§Ø²Ø§Ø±</div>
                </div>
                <div class="quick-link" onclick="showNotification('Ø¨Û•Ø´ÛŒ Ù…Ø§Ø±Ú©ÛØªÙ¾ÚµÛ•ÛŒØ³', 'success')">
                    <div class="quick-link-icon">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div class="quick-link-label">Ù…Ø§Ø±Ú©ÛØªÙ¾ÚµÛ•ÛŒØ³</div>
                </div>
            </div>

            <!-- Admin Panel -->
            <div class="admin-panel" id="adminPanel">
                <div class="admin-title">Ø¨Û•Ú•ÛÙˆÛ•Ø¨Û•Ø±ÛŒ Ú©Ø§ÚµØ§Ú©Ø§Ù†</div>
                <form class="admin-form" id="adminForm">
                    <input type="text" class="admin-input" id="productName" placeholder="Ù†Ø§ÙˆÛŒ Ú©Ø§ÚµØ§" required>
                    <input type="number" class="admin-input" id="productPrice" placeholder="Ù†Ø±Ø® (Ø¯ÛŒÙ†Ø§Ø±)" required>
                    <input type="text" class="admin-input" id="productCode" placeholder="Ú©Û†Ø¯ÛŒ Ú©Ø§ÚµØ§" required>
                    <select class="admin-select" id="productCategory" required>
                        <option value="">Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†ÛŒ Ø¬Û†Ø±</option>
                        <option value="clothing">Ø¬Ù„</option>
                        <option value="hat">Ú©ÚµØ§Ùˆ</option>
                        <option value="mug">Ú©ÙˆÙˆÙ¾</option>
                        <option value="watermelon">ØªÛ•Ø±Ù…Û†Ø²Û•</option>
                        <option value="notebook">Ø¯Û•ÙØªÛ•Ø±</option>
                        <option value="pen">Ù‚Û•Ù„Û•Ù…</option>
                        <option value="bag">Ø¬Ø§Ù†ØªØ§</option>
                        <option value="crystal">Ú©Ø±ÛŒØ³ØªØ§Ù„</option>
                        <option value="shield">Ø¯Ø±Ø¹</option>
                        <option value="krikar">Ú©Ø±ÛŒÚ©Ø§Ø±</option>
                        <option value="other">Ø´ØªÛŒ ØªØ±</option>
                    </select>
                    
                    <div class="multiple-images-preview" id="multipleImagesPreview">
                        <!-- Multiple images preview will be shown here -->
                    </div>
                    
                    <input type="file" class="admin-file-input" id="productImages" accept="image/*" multiple>
                    
                    <button type="submit" class="admin-button" id="submitButton">
                        <span id="submitButtonText">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§</span>
                    </button>
                    <button type="button" class="admin-button delete" id="closeAdminPanel">Ø¯Ø§Ø®Ø³ØªÙ†ÛŒ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Û•Ø±</button>
                </form>

                <!-- Admin Products Section -->
                <div class="admin-products-section" id="adminProductsSection">
                    <div class="admin-products-title">Ú©Ø§ÚµØ§Ú©Ø§Ù† Ø¨Û† Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ Ùˆ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•</div>
                    <div class="products-grid" id="adminProductsContainer">
                        <!-- Products will be loaded here with edit/delete buttons -->
                    </div>
                </div>
            </div>

            <!-- Contact Section -->
            <div class="contact-section">
                <div class="contact-title">Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒ</div>
                <div class="contact-grid">
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="contact-label">Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Û†Ø¨Ø§ÛŒÙ„</div>
                        <div class="contact-value">-7701922060</div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="contact-label">Ø¦ÛŒÙ…Û•ÛŒÚµ</div>
                        <div class="contact-value">paywastwork@gmail.com</div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="contact-label">Ø´ÙˆÛÙ†</div>
                        <div class="contact-value">Ø³Ù„ÛÙ…Ø§Ù†ÛŒ</div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="contact-label">Ú©Ø§ØªÛ•Ú©Ø§Ù†ÛŒ Ú©Ø§Ø±</div>
                        <div class="contact-value">Ù©:Ù Ù  - Ù¡Ù§:Ù Ù </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="footer">
                <p>Ù¾Ú•Û†Ù…Û† Ù‡Û†Ø³ - Ù‡Û•Ù…ÙˆÙˆ Ù…Ø§ÙÛ•Ú©Ø§Ù† Ù¾Ø§Ø±ÛØ²Ø±Ø§ÙˆÙ† Â© Ù¢Ù Ù¢Ù£</p>
                <p>Ù¾Û•ÛŒÙˆÛ•Ù†Ø¯ÛŒÙ…Ø§Ù† Ù¾ÛÙˆÛ•Ø¨Ú©Û•: Ù Ù§Ù§Ù  XXX XXXX | example@promohouse.com</p>
            </div>
        </div>
    </div>

    <div class="password-prompt" id="passwordPrompt" style="display: none;">
        <div class="password-container">
            <div class="password-title">ØªÚ©Ø§ÛŒÛ• ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Û•Ø± Ø¨Ù†ÙˆÙˆØ³Û•</div>
            <input type="password" class="password-input" id="adminPassword" placeholder="ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ">
            <div class="password-buttons">
                <button class="password-button password-cancel" id="cancelPassword">Ù¾Ø§Ø´Ú¯Û•Ø²Ø¨ÙˆÙˆÙ†Û•ÙˆÛ•</button>
                <button class="password-button password-submit" id="submitPassword">Ú†ÙˆÙˆÙ†Û• Ù†Ø§ÙˆÛ•ÙˆÛ•</button>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCl1EUC9r6lu9L0opp-gFst3Y7Hjk7jH-M",
            authDomain: "promohouse-b5298.firebaseapp.com",
            databaseURL: "https://promohouse-b5298-default-rtdb.firebaseio.com",
            projectId: "promohouse-b5298",
            storageBucket: "promohouse-b5298.firebasestorage.app",
            messagingSenderId: "55413367728",
            appId: "1:55413367728:web:c23d315d95482c0e0f2c75",
            measurementId: "G-XRZP1J2QMG"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const storage = firebase.storage();

        console.log('ğŸ”¥ Firebase initialized successfully');

        // Global variables
        let allProducts = [];
        let currentEditingProductId = null;
        const ADMIN_PASSWORD = "admin123"; // ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Û•Ø±
        
        // Helper function to get icon based on category
        function getIcon(category) {
            switch (category) {
                case 'clothing': return 'fa-tshirt';
                case 'hat': return 'fa-hat-cowboy';
                case 'mug': return 'fa-mug-hot';
                case 'watermelon': return 'fa-flask'; // Using a placeholder icon
                case 'notebook': return 'fa-book';
                case 'pen': return 'fa-pen';
                case 'bag': return 'fa-shopping-bag';
                case 'crystal': return 'fa-gem';
                case 'shield': return 'fa-shield-alt';
                case 'krikar': return 'fa-hand-holding';
                default: return 'fa-box-open';
            }
        }

        // Function to format date for display
        function formatDate(timestamp) {
            if (!timestamp) return 'Ø¨Û•Ø±ÙˆØ§Ø±ÛŒ Ù†Û•Ø²Ø§Ù†Ø±Ø§Ùˆ';
            
            const date = new Date(timestamp);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            // If today
            if (date.toDateString() === now.toDateString()) {
                return 'Ø¦Û•Ù…Ø±Û†';
            }
            // If yesterday
            const yesterday = new Date(now);
            yesterday.setDate(yesterday.getDate() - 1);
            if (date.toDateString() === yesterday.toDateString()) {
                return 'Ø¯ÙˆÛÙ†Û';
            }
            // If within this week
            if (diffDays <= 7) {
                return `${diffDays} Ú•Û†Ú˜ Ù„Û•Ù…Û•ÙˆÙ¾ÛØ´`;
            }
            
            // Otherwise show full date
            return date.toLocaleDateString('ku-IQ', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Function to show notification
        function showNotification(message, type = 'success') {
            let notification = document.querySelector('.notification');
            if (!notification) {
                notification = document.createElement('div');
                notification.className = 'notification';
                document.body.appendChild(notification);
            }
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in forwards';
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.style.animation = 'slideIn 0.3s ease-out'; // Reset animation
                }, 300);
            }, 3000);
        }

        // Function to show USD Price
        function showUSDPrice(priceIQD, productName) {
            const usdPrice = (priceIQD / 1470).toFixed(2);
            showNotification(`${productName}: ${priceIQD.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø± = Ù†Ø²ÛŒÚ©Û•ÛŒ ${usdPrice}$`, 'success');
        }

        // Function to handle category filtering
        function filterProducts(category) {
            const productsContainer = document.getElementById('productsContainer');
            const products = productsContainer.querySelectorAll('.product-item');
            
            products.forEach(product => {
                const productCategory = product.getAttribute('data-category');
                if (category === 'all' || productCategory === category) {
                    product.style.display = 'block';
                } else {
                    product.style.display = 'none';
                }
            });
            
            // Update active category style
            const categoryItems = document.querySelectorAll('.category-item');
            categoryItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-category') === category) {
                    item.classList.add('active');
                }
            });
        }

        // Function to filter products by date
        function filterProductsByDate(dateFilter) {
            const productsContainer = document.getElementById('productsContainer');
            const products = productsContainer.querySelectorAll('.product-item');
            const now = new Date();
            
            products.forEach(product => {
                const productDateStr = product.getAttribute('data-created-date');
                if (!productDateStr) {
                    product.style.display = 'none';
                    return;
                }
                
                const productDate = new Date(parseInt(productDateStr));
                let shouldShow = true;
                
                switch (dateFilter) {
                    case 'today':
                        shouldShow = productDate.toDateString() === now.toDateString();
                        break;
                    case 'yesterday':
                        const yesterday = new Date(now);
                        yesterday.setDate(yesterday.getDate() - 1);
                        shouldShow = productDate.toDateString() === yesterday.toDateString();
                        break;
                    case 'week':
                        const weekAgo = new Date(now);
                        weekAgo.setDate(weekAgo.getDate() - 7);
                        shouldShow = productDate >= weekAgo;
                        break;
                    case 'month':
                        const monthAgo = new Date(now);
                        monthAgo.setMonth(monthAgo.getMonth() - 1);
                        shouldShow = productDate >= monthAgo;
                        break;
                    case 'new':
                        const sevenDaysAgo = new Date(now);
                        sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
                        shouldShow = productDate >= sevenDaysAgo;
                        break;
                    case 'all':
                    default:
                        shouldShow = true;
                        break;
                }
                
                product.style.display = shouldShow ? 'block' : 'none';
            });
            
            // Update date display
            const dateDisplay = document.getElementById('dateDisplay');
            const filterText = document.getElementById('dateFilter').options[document.getElementById('dateFilter').selectedIndex].text;
            dateDisplay.textContent = `ÙÛŒÙ„ØªÛ•Ø±: ${filterText}`;
        }

        // Function to create image slider for products with multiple images
        function createImageSlider(images, productId) {
            const sliderId = `slider-${productId}`;
            const dots = images.map((_, index) => 
                `<div class="slider-dot ${index === 0 ? 'active' : ''}" data-index="${index}" onclick="handleDotClick(event, '${sliderId}')"></div>`
            ).join('');
            
            const imageElements = images.map((image, index) => 
                `<img src="${image}" alt="Product image ${index + 1}" class="slider-image" onerror="handleImageError(this, ${index}, '${sliderId}')">`
            ).join('');
            
            return `
                <div class="image-slider" id="${sliderId}" data-current-image="0">
                    <div class="slider-container">
                        ${imageElements}
                    </div>
                    <button class="slider-arrow prev" onclick="slideImage('${sliderId}', -1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    <button class="slider-arrow next" onclick="slideImage('${sliderId}', 1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="slider-nav">
                        ${dots}
                    </div>
                </div>
            `;
        }

        // Function to handle dot click (jump to specific image)
        function handleDotClick(event, sliderId) {
            event.stopPropagation(); // Stop propagation to prevent opening product details
            const newIndex = parseInt(event.target.dataset.index);
            const slider = document.getElementById(sliderId);
            if (!slider) return;
            
            const container = slider.querySelector('.slider-container');
            const dots = slider.querySelectorAll('.slider-dot');

            // Calculate the translation amount
            const translateValue = -newIndex * 100;
            container.style.transform = `translateX(${translateValue}%)`;

            // Update dots
            dots.forEach(dot => dot.classList.remove('active'));
            event.target.classList.add('active');

            slider.setAttribute('data-current-image', newIndex);
        }

        // Function to handle image sliding
        function slideImage(sliderId, direction) {
            event.stopPropagation(); // Stop propagation to prevent opening product details
            const slider = document.getElementById(sliderId);
            if (!slider) return;
            
            const container = slider.querySelector('.slider-container');
            const images = slider.querySelectorAll('.slider-image');
            const dots = slider.querySelectorAll('.slider-dot');
            
            if (images.length <= 1) return;
            
            const currentActiveDot = slider.querySelector('.slider-dot.active');
            let currentIndex = parseInt(currentActiveDot ? currentActiveDot.dataset.index : 0);
            
            let newIndex = currentIndex + direction;
            
            // Handle looping
            if (newIndex >= images.length) {
                newIndex = 0;
            } else if (newIndex < 0) {
                newIndex = images.length - 1;
            }

            // Calculate the translation amount
            const translateValue = -newIndex * 100; // Each image takes up 100% of the slider width
            container.style.transform = `translateX(${translateValue}%)`;

            // Update dots
            dots.forEach(dot => dot.classList.remove('active'));
            if (dots[newIndex]) {
                dots[newIndex].classList.add('active');
            }

            slider.setAttribute('data-current-image', newIndex);
        }
        
        // Function to handle image loading error (to prevent breaking the slider logic)
        function handleImageError(imgElement, index, sliderId) {
            console.error('Image failed to load:', imgElement.src);
            // In a slider, simply hide the broken image. The slider logic will still work for the others.
            imgElement.style.display = 'none'; 
            // If all images fail, the placeholder will be needed, but this is a more complex error handling.
        }

        // Function to create product item with image slider (UPDATED)
        function createProductItem(product, productId) {
            const productItem = document.createElement('div');
            productItem.className = `product-item ${product.isNew ? 'new-product' : ''}`;
            productItem.setAttribute('data-category', product.category);
            productItem.setAttribute('data-id', productId);
            productItem.setAttribute('data-created-date', product.createdAt || '');

            const icon = getIcon(product.category);
            const usdPrice = (product.price / 1470).toFixed(2);
            
            // Get images array or use single image
            // Ensures `images` is an array of strings (URLs)
            const images = (product.images && Array.isArray(product.images)) ? product.images : (product.imageUrl ? [product.imageUrl] : []);
            
            // Create image slider if multiple images, otherwise single image
            let imageContent;
            let sliderScript = '';
            
            if (images.length > 1) {
                imageContent = createImageSlider(images, productId);
            } else if (images.length === 1) {
                imageContent = `<img src="${images[0]}" alt="${product.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">`;
            } else {
                imageContent = `<div class="placeholder-icon"><i class="fas ${icon}"></i></div>`;
            }

            productItem.innerHTML = `
                ${product.isNew ? '<div class="new-badge">NEW</div>' : ''}
                <div class="price-eye" onclick="event.stopPropagation(); showUSDPrice(${product.price}, '${product.name}')">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="product-image">
                    ${imageContent}
                    ${images.length <= 1 ? `<div class="placeholder-icon" style="${images.length === 1 ? 'display:none;' : ''}"><i class="fas ${icon}"></i></div>` : ''}
                </div>
                <div class="product-info">
                    <div class="product-name">${product.name}</div>
                    <div class="product-price">${product.price.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                    <div class="product-price-usd">Ù†Ø²ÛŒÚ©Û•ÛŒ ${usdPrice}$</div>
                    <div class="product-code">${product.code}</div>
                    <div class="product-date">Ø²ÛŒØ§Ø¯Ú©Ø±Ø§ÙˆÛ•: ${formatDate(product.createdAt)}</div>
                </div>
            `;
            
            // Add click handler for admin access if needed
            productItem.addEventListener('click', () => {
                console.log('Product clicked:', productId);
                // Implement logic to show product details or similar action
            });

            return productItem;
        }

        // Function to load products
        function loadProducts() {
            const productsContainer = document.getElementById('productsContainer');
            
            console.log('ğŸ”„ Starting to load products...');

            // Show loading state
            productsContainer.innerHTML = `
                <div style="text-align: center; grid-column: 1 / -1; padding: 20px;">
                    <div class="loading"></div>
                    <div>Ú©Ø§ÚµØ§Ú©Ø§Ù† Ø¨Ø§Ø± Ø¯Û•Ú©Ø±ÛÙ†...</div>
                </div>
            `;

            // Listen for products from Realtime Database
            const productsRef = database.ref('products');
            
            productsRef.on('value', (snapshot) => {
                console.log('ğŸ“¦ Firebase data received:', snapshot.val());
                
                const productsData = snapshot.val();
                const productsContainer = document.getElementById('productsContainer');
                
                // Clear container
                productsContainer.innerHTML = '';
                
                if (!productsData) {
                    console.log('â„¹ï¸ No products found in database');
                    productsContainer.innerHTML = `
                        <div style="text-align: center; grid-column: 1 / -1; padding: 20px; color: #666;">
                            <i class="fas fa-box-open" style="font-size: 40px; margin-bottom: 10px;"></i>
                            <div>Ù‡ÛŒÚ† Ú©Ø§ÚµØ§ÛŒÛ•Ú© Ø¨ÙˆÙˆÙ†ÛŒ Ù†ÛŒÛ•</div>
                            <button onclick="addSampleProducts()" style="margin-top: 10px; padding: 8px 16px; background: #4fc3f7; color: white; border: none; border-radius: 6px; cursor: pointer;">
                                Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§ÛŒ Ù†Ù…ÙˆÙˆÙ†Û•ÛŒÛŒ
                            </button>
                        </div>
                    `;
                    return;
                }
                
                // Convert object to array
                allProducts = Object.keys(productsData).map(productId => ({
                    id: productId,
                    ...productsData[productId]
                }));
                
                console.log('ğŸ¯ Products loaded:', allProducts.length);
                
                // Add products to container
                allProducts.forEach(product => {
                    const productItem = createProductItem(product, product.id);
                    productsContainer.appendChild(productItem);
                });

                // Re-filter based on current active category if any
                const activeCategory = document.querySelector('.category-item.active');
                if (activeCategory) {
                    filterProducts(activeCategory.getAttribute('data-category'));
                }
                
                // Apply date filter if set
                const dateFilter = document.getElementById('dateFilter').value;
                if (dateFilter !== 'all') {
                    filterProductsByDate(dateFilter);
                }
                
                // If admin panel is open, refresh admin product list
                if (document.getElementById('adminPanel').classList.contains('show')) {
                    renderAdminProducts();
                }
                
            }, (error) => {
                console.error('âŒ Error loading products:', error);
                showNotification('Ù‡Û•ÚµÛ• Ù„Û• Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§Ú©Ø§Ù†', 'error');
                
                productsContainer.innerHTML = `
                    <div style="text-align: center; grid-column: 1 / -1; padding: 20px; color: #f44336;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 40px; margin-bottom: 10px;"></i>
                        <div>Ù‡Û•ÚµÛ• Ù„Û• Ø¨Ø§Ø±Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§Ú©Ø§Ù†</div>
                        <div style="font-size: 12px; margin-top: 5px;">${error.message}</div>
                        <button onclick="loadProducts()" style="margin-top: 10px; padding: 8px 16px; background: #4fc3f7; color: white; border: none; border-radius: 6px; cursor: pointer;">
                            Ù‡Û•ÙˆÚµØ¯Ø§Ù†Û•ÙˆÛ•
                        </button>
                    </div>
                `;
            });
        }

        // Function to render admin products (FOR ADMIN PANEL)
        function renderAdminProducts() {
            const adminProductsContainer = document.getElementById('adminProductsContainer');
            adminProductsContainer.innerHTML = '';
            
            allProducts.forEach(product => {
                const productItem = createProductItem(product, product.id);
                
                // Add admin actions (edit/delete)
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'product-actions';

                const editBtn = document.createElement('div');
                editBtn.className = 'edit-btn';
                editBtn.innerHTML = '<i class="fas fa-edit"></i>';
                editBtn.onclick = (e) => {
                    e.stopPropagation();
                    editProduct(product.id);
                };

                const deleteBtn = document.createElement('div');
                deleteBtn.className = 'delete-btn';
                deleteBtn.innerHTML = '<i class="fas fa-trash-alt"></i>';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    deleteProduct(product.id, product.images);
                };

                actionsDiv.appendChild(editBtn);
                actionsDiv.appendChild(deleteBtn);
                productItem.appendChild(actionsDiv);
                
                adminProductsContainer.appendChild(productItem);
            });
        }

        // Setup Event Listeners and Initial Load
        document.addEventListener('DOMContentLoaded', () => {
            loadProducts();
            
            // Category Nav Listeners
            const categoryItems = document.querySelectorAll('.category-item');
            categoryItems.forEach(item => {
                item.addEventListener('click', () => {
                    const category = item.getAttribute('data-category');
                    filterProducts(category);
                });
            });

            // Date Filter Listeners
            const dateFilter = document.getElementById('dateFilter');
            const applyDateFilter = document.getElementById('applyDateFilter');
            
            applyDateFilter.addEventListener('click', () => {
                filterProductsByDate(dateFilter.value);
            });

            // Admin Access Logic
            const adminAccessBtn = document.getElementById('adminAccessBtn');
            const passwordPrompt = document.getElementById('passwordPrompt');
            const submitPassword = document.getElementById('submitPassword');
            const cancelPassword = document.getElementById('cancelPassword');
            const adminPanel = document.getElementById('adminPanel');
            const closeAdminPanel = document.getElementById('closeAdminPanel');

            let isAdmin = false;

            adminAccessBtn.addEventListener('click', () => {
                if (isAdmin) {
                    adminPanel.classList.toggle('show');
                    if (adminPanel.classList.contains('show')) {
                        renderAdminProducts();
                    }
                } else {
                    passwordPrompt.style.display = 'flex';
                    document.getElementById('adminPassword').value = '';
                }
            });

            submitPassword.addEventListener('click', () => {
                const password = document.getElementById('adminPassword').value;
                if (password === ADMIN_PASSWORD) {
                    isAdmin = true;
                    passwordPrompt.style.display = 'none';
                    adminPanel.classList.add('show');
                    showNotification('Ú†ÙˆÙˆÙ†Û•Ú˜ÙˆÙˆØ±Û•ÙˆÛ•ÛŒ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Û•Ø± Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆ Ø¨ÙˆÙˆ', 'success');
                    renderAdminProducts();
                } else {
                    showNotification('ÙˆØ´Û•ÛŒ Ù†Ù‡ÛÙ†ÛŒ Ù‡Û•ÚµÛ•ÛŒÛ•', 'error');
                }
            });

            cancelPassword.addEventListener('click', () => {
                passwordPrompt.style.display = 'none';
            });
            
            closeAdminPanel.addEventListener('click', () => {
                adminPanel.classList.remove('show');
                currentEditingProductId = null;
                document.getElementById('submitButtonText').textContent = 'Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§';
                document.getElementById('adminForm').reset();
                document.getElementById('multipleImagesPreview').innerHTML = '';
            });

            // Add/Edit Product Logic
            const adminForm = document.getElementById('adminForm');
            const productImagesInput = document.getElementById('productImages');
            const multipleImagesPreview = document.getElementById('multipleImagesPreview');
            let filesToUpload = []; // Array to hold new files

            productImagesInput.addEventListener('change', (e) => {
                filesToUpload = Array.from(e.target.files);
                previewMultipleImages(filesToUpload);
            });

            function previewMultipleImages(files) {
                multipleImagesPreview.innerHTML = '';
                files.forEach((file, index) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const imageItem = document.createElement('div');
                        imageItem.className = 'multiple-image-item';
                        imageItem.innerHTML = `
                            <img src="${e.target.result}" alt="Preview ${index}">
                            <button type="button" class="remove-image" data-index="${index}"><i class="fas fa-times"></i></button>
                        `;
                        multipleImagesPreview.appendChild(imageItem);

                        imageItem.querySelector('.remove-image').addEventListener('click', (event) => {
                            const removeIndex = parseInt(event.currentTarget.dataset.index);
                            filesToUpload.splice(removeIndex, 1);
                            previewMultipleImages(filesToUpload); // Re-render preview to update indices
                            if (filesToUpload.length === 0) {
                                productImagesInput.value = ''; // Clear file input
                            }
                        });
                    };
                    reader.readAsDataURL(file);
                });
            }
            
            adminForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!isAdmin) return showNotification('ØªÛ† Ù…Û†ÚµÛ•ØªÛŒ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Û•Ø±ÛŒØª Ù†ÛŒÛ•.', 'error');

                const submitButton = document.getElementById('submitButton');
                submitButton.disabled = true;
                const originalText = submitButton.textContent;
                submitButton.innerHTML = `<span class="loading"></span> Ú†Ø§ÙˆÛ•Ú•ÛØ¨Û•...`;

                const name = document.getElementById('productName').value;
                const price = parseInt(document.getElementById('productPrice').value);
                const code = document.getElementById('productCode').value;
                const category = document.getElementById('productCategory').value;

                try {
                    let imageUrls = [];
                    
                    if (currentEditingProductId) {
                        // Get existing images if editing
                        const existingProduct = allProducts.find(p => p.id === currentEditingProductId);
                        imageUrls = existingProduct.images || (existingProduct.imageUrl ? [existingProduct.imageUrl] : []);
                    }

                    // Upload new files
                    for (const file of filesToUpload) {
                        const storageRef = storage.ref(`product_images/${category}/${file.name}_${Date.now()}`);
                        const snapshot = await storageRef.put(file);
                        const downloadURL = await snapshot.ref.getDownloadURL();
                        imageUrls.push(downloadURL);
                    }

                    // Remove duplicates (optional, based on your design)
                    imageUrls = Array.from(new Set(imageUrls));

                    const productData = {
                        name,
                        price,
                        code,
                        category,
                        images: imageUrls, // Store multiple images
                        isNew: !currentEditingProductId, // New product if no ID
                        // Add creation date - use existing date for edits, current time for new products
                        createdAt: currentEditingProductId ? 
                            (allProducts.find(p => p.id === currentEditingProductId)?.createdAt || Date.now()) : 
                            Date.now()
                    };

                    if (currentEditingProductId) {
                        // Update existing product
                        await database.ref('products/' + currentEditingProductId).update(productData);
                        showNotification('Ú©Ø§ÚµØ§ Ø¨Û• Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆÛŒÛŒ Ù†ÙˆÛ Ú©Ø±Ø§ÛŒÛ•ÙˆÛ•', 'success');
                    } else {
                        // Add new product
                        await database.ref('products').push(productData);
                        showNotification('Ú©Ø§ÚµØ§ Ø¨Û• Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆÛŒÛŒ Ø²ÛŒØ§Ø¯ Ú©Ø±Ø§', 'success');
                    }

                    adminForm.reset();
                    currentEditingProductId = null;
                    document.getElementById('submitButtonText').textContent = 'Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§';
                    multipleImagesPreview.innerHTML = '';
                    filesToUpload = [];

                } catch (error) {
                    console.error('Error adding/updating product:', error);
                    showNotification('Ù‡Û•ÚµÛ• Ù„Û• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†/Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ú©Ø§ÚµØ§: ' + error.message, 'error');
                } finally {
                    submitButton.disabled = false;
                    submitButton.textContent = originalText;
                }
            });

            // Delete Product Function
            async function deleteProduct(productId, images) {
                if (confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒ Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ú©Ø§ÚµØ§ÛŒÛ•ØŸ')) {
                    try {
                        // Delete images from storage
                        if (images && Array.isArray(images)) {
                            for (const url of images) {
                                const imageRef = storage.refFromURL(url);
                                await imageRef.delete().catch(error => {
                                    console.warn('Failed to delete image from storage (may not exist or permission issue):', error);
                                });
                            }
                        }

                        // Delete product from database
                        await database.ref('products/' + productId).remove();
                        showNotification('Ú©Ø§ÚµØ§ Ø¨Û• Ø³Û•Ø±Ú©Û•ÙˆØªÙˆÙˆÛŒÛŒ Ø³Ú•Ø§ÛŒÛ•ÙˆÛ•', 'success');
                    } catch (error) {
                        console.error('Error deleting product:', error);
                        showNotification('Ù‡Û•ÚµÛ• Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ú©Ø§ÚµØ§: ' + error.message, 'error');
                    }
                }
            }

            // Edit Product Function
            function editProduct(productId) {
                const product = allProducts.find(p => p.id === productId);
                if (!product) return showNotification('Ú©Ø§ÚµØ§ Ù†Û•Ø¯Û†Ø²Ø±Ø§ÛŒÛ•ÙˆÛ•', 'error');

                currentEditingProductId = productId;
                document.getElementById('productName').value = product.name;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productCode').value = product.code;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('submitButtonText').textContent = 'Ù†ÙˆÛÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ú©Ø§ÚµØ§';
                document.getElementById('productImages').value = ''; // Clear file input for new uploads
                filesToUpload = []; // Clear new files array

                // Show current images (URLs only - no remove functionality here for simplicity)
                const images = product.images || (product.imageUrl ? [product.imageUrl] : []);
                multipleImagesPreview.innerHTML = images.map((url, index) => `
                    <div class="multiple-image-item" title="Existing Image">
                        <img src="${url}" alt="Existing Image ${index}">
                        <span style="position: absolute; top: 0; left: 0; background: rgba(0,0,0,0.5); color: white; padding: 2px 4px; font-size: 8px; border-radius: 4px;">Ú©Û†Ù†</span>
                    </div>
                `).join('');

                document.getElementById('adminPanel').classList.add('show');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            // Add Sample Products Function
            async function addSampleProducts() {
                const now = Date.now();
                const oneDay = 24 * 60 * 60 * 1000;
                
                const sampleProducts = [
                    { 
                        name: 'ØªÛŒØ´ÛØ±ØªÛŒ Ø³Ù¾ÛŒ', 
                        price: 15000, 
                        code: 'T001', 
                        category: 'clothing', 
                        images: [
                            'https://via.placeholder.com/150/0000FF/FFFFFF?text=T-Shirt+Blue', 
                            'https://via.placeholder.com/150/FF0000/FFFFFF?text=T-Shirt+Red'
                        ], 
                        isNew: true,
                        createdAt: now - (2 * oneDay) // 2 days ago
                    },
                    { 
                        name: 'Ú©ÚµØ§ÙˆÛŒ Ú•Û•Ø´', 
                        price: 8000, 
                        code: 'H005', 
                        category: 'hat', 
                        images: [
                            'https://via.placeholder.com/150/333333/FFFFFF?text=Black+Hat'
                        ], 
                        isNew: false,
                        createdAt: now - (10 * oneDay) // 10 days ago
                    },
                    { 
                        name: 'Ú©ÙˆÙˆÙ¾ÛŒ Ù„Û†Ú¯Û†Ø¯Ø§Ø±', 
                        price: 10000, 
                        code: 'M100', 
                        category: 'mug', 
                        images: [
                            'https://via.placeholder.com/150/FFC107/333333?text=Logo+Mug', 
                            'https://via.placeholder.com/150/03A9F4/333333?text=Logo+Mug+2', 
                            'https://via.placeholder.com/150/4CAF50/333333?text=Logo+Mug+3'
                        ], 
                        isNew: true,
                        createdAt: now // Today
                    }
                ];
                
                try {
                    for (const product of sampleProducts) {
                        await database.ref('products').push(product);
                    }
                    showNotification('Ú©Ø§ÚµØ§ Ù†Ù…ÙˆÙˆÙ†Û•ÛŒÛŒÛ•Ú©Ø§Ù† Ø²ÛŒØ§Ø¯ Ú©Ø±Ø§Ù†', 'success');
                } catch (error) {
                    console.error('Error adding sample products:', error);
                    showNotification('Ù‡Û•ÚµÛ• Ù„Û• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ú©Ø§ÚµØ§ÛŒ Ù†Ù…ÙˆÙˆÙ†Û•ÛŒÛŒ', 'error');
                }
            }

            // Make functions globally available
            window.addSampleProducts = addSampleProducts;
            window.deleteProduct = deleteProduct;
            window.editProduct = editProduct;
            window.showUSDPrice = showUSDPrice;
            window.slideImage = slideImage;
            window.handleDotClick = handleDotClick;
            window.handleImageError = handleImageError;
            window.showNotification = showNotification;
            window.filterProducts = filterProducts;
            window.filterProductsByDate = filterProductsByDate;
            window.formatDate = formatDate;
        });
    </script>
</body>
</html>

